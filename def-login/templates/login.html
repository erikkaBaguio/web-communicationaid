<html>
	<head>
		<meta charset="UTF-8">
		<title>Login</title>
		<style>
			.body{
				position: absolute;
				pverflow-y: scroll
				width: 100%
				top: -20px;
				right: -40px;
				bottom: -40px;
				width: auto;
				height: auto;
				background-size: full;
				-webkit-filter: blur(0px);
			}
			
			.head{
				position: absolute;
				top: calc (50% - 35px);
				left: calc (50% - 255px);
			}
			
			.header div{
				float: left;
				color: #000;
				font-family: 'Exo', sans-serif;
				font-size: 40px;
				font-weight: 200;
			}
			
			.header div span{
				color: #F29E20 !important;
			}
			
			.login{
				position: absolute;
				top: calc (50% - 75px);
				left: calc (50% - 50px);
				height: 150px;
				width: 350px;
				padding: 10px;
			}
			
			.login input [type=text]{
				width: 250px;
				height: 30px;
				background: transparent;
				border: 1px solid rgba(255,255,255,0.6);
				border-radius: 2px;
				color: #fff;
				font-family: 'Exo', sans-serif;
				font-size: 16px;
				font-weight: 400;
				padding: 4px;
			}
			
			.login input [type=password]{
				width: 250px;
				height: 30px;
				background: transparent;
				border: 1px solid rgba(255,255,255,0.6);
				border-radius: 2px;
				color: #fff;
				font-family: 'Exo', sans-serif;
				font-size: 16px;
				font-weight: 400;
				padding: 4px;
			}
			
			.login input [type=button]{
				width: 260px;
				height: 35px;
				background: #fff;
				border: 1px solid #fff;
				cursor: pointer;
				border-radius: 2px;
				color: #a18d6c;
				font-family: 'Exo', sans-serif;
				font-size: 16px;
				font-weight: 400;
				padding: 4px;
			}
			
			.login input [type=button]:hover{
				opacity: 0.8;
			}
			
			.login input [type=button]:active{
				opacity: 0.6;
			}
			
			.login input [type=text]:focus{
				outline: none;
				border: 1px solid rgba (255,255,255,0.9);
			}
			
			.login input [type=password]:focus{
				outline: none;
				border: 1px solid rgba (255,255,255,0.9);
			}
			
			.login input [type=button]:focus{
				outline: none;
			}

		</style>
	</head>
	<body oncontextmenu="return false">
		<div class="body"></div>
		<div class="grad"></div>
		<div class="header">
			<div>Log<span>In</span></div><br>
		</div>
		<br>
		<form name="login" id="login" method="post" action="/login">
		<div class="login">
			<input type="text" placeholder="username" name="usern" id="usern"><br>
			<input type="password" placeholder="password" name="passw" id="passw"><br>
			<input type="button"  value="Login">
		</div>
		</form>
		
		<script type="text/javascript">
		        $('#login').submit(function () {
                var username = $("#usern").val();
                var password = $("#passw").val();

                $.ajax({
                    url: "http://127.0.0.1:5000/api/login/",
                    contentType: 'application/json; charset=utf-8',
                    data: JSON.stringify({
                        'username': username,
                        'password': password
                    }),
                    method: "GET",
                    dataType: "json",
                    crossDomain: true,
                    headers: {
                        'Authorization': 'Basic ' + btoa(username + ':' + password)
                    },
                    success: function (resp) {
                        if (resp.acc_type == 'Teacher') {
                            alert('login success!');
                            console.log("success");
                            localStorage.setItem('token', resp.token);
                            localStorage.setItem('acc_id', resp.acc_id);
                            localStorage.setItem('acc_type', resp.acc_type);
                            localStorage.setItem('auth_id', 'Basic ' + btoa(username + ':' + password));
                            window.location.href = '/teacher/landing';
                        }
                        if (resp.acc_type == 'Parent') {
                            alert('login success!');
                            console.log("success");
                            localStorage.setItem('token', resp.token);
                            localStorage.setItem('acc_id', resp.acc_id);
                            localStorage.setItem('acc_type', resp.acc_type);
                            localStorage.setItem('auth_id', 'Basic ' + btoa(username + ':' + password));
                            window.location.href = '/parent/landing';
                        }
                    },
                    error: function () {
                        console.log('error');
                        alert('Invalid Credentials!');
                        window.location.href = '/';
                    },
                    complete: function (jqXHR) {
                        if (jqXHR.status == '401') {
                            console.log(jqXHR.status)
                        }
                    }
                })
            });
		</script>	
	</body>
</html>